{
    "id": "overshootUndershoot",
    "label": "Generic overshoot/undershoot pattern",
    "description": "Generic overshoot/undershoot pattern. The unit for threshold values is cm.",
    "parameters": [
        {
            "name" : "observedProperty",
            "dataType" : "text"
        },
        {
            "name" : "sensorID",
            "dataType" : "text"
        },
        {
            "name" : "thresholdValue",
            "dataType" : "number"
        }
    ],
    "definition" : {
        "content" : "&lt;EML xmlns=&quot;http://www.opengis.net/eml/0.0.1&quot;&gt;&lt;SimplePatterns&gt;&lt;SimplePattern inputName=&quot;input&quot; patternID=&quot;${observedProperty}_initial_count&quot;&gt;&lt;SelectFunctions&gt;&lt;SelectFunction newEventName=&quot;${observedProperty}_initial_count_stream&quot;&gt;&lt;SelectEvent eventName=&quot;input&quot; /&gt;&lt;/SelectFunction&gt;&lt;/SelectFunctions&gt;&lt;View&gt;&lt;LengthView&gt;&lt;EventCount&gt;2&lt;/EventCount&gt;&lt;/LengthView&gt;&lt;/View&gt;&lt;Guard&gt;&lt;fes:Filter xmlns:fes=&quot;http://www.opengis.net/fes/2.0&quot;&gt;&lt;fes:PropertyIsEqualTo&gt;&lt;fes:ValueReference&gt;VIEW_COUNT&lt;/fes:ValueReference&gt;&lt;ns:Literal xmlns:ns=&quot;http://www.opengis.net/fes/2.0&quot;&gt;&lt;ns1:Count xmlns:ns1=&quot;http://www.opengis.net/swe/1.0.1&quot;&gt;&lt;ns1:value&gt;1&lt;/ns1:value&gt;&lt;/ns1:Count&gt;&lt;/ns:Literal&gt;&lt;/fes:PropertyIsEqualTo&gt;&lt;/fes:Filter&gt;&lt;/Guard&gt;&lt;PropertyRestrictions&gt;&lt;PropertyRestriction&gt;&lt;name&gt;observedProperty&lt;/name&gt;&lt;value&gt;${observedProperty}&lt;/value&gt;&lt;/PropertyRestriction&gt;&lt;PropertyRestriction&gt;&lt;name&gt;sensorID&lt;/name&gt;&lt;value&gt;${sensorID}&lt;/value&gt;&lt;/PropertyRestriction&gt;&lt;/PropertyRestrictions&gt;&lt;/SimplePattern&gt;&lt;SimplePattern inputName=&quot;input&quot; patternID=&quot;${observedProperty}_threshold_undershoot&quot;&gt;&lt;SelectFunctions&gt;&lt;SelectFunction createCausality=&quot;false&quot; newEventName=&quot;${observedProperty}_threshold_undershoot_stream&quot;&gt;&lt;SelectEvent eventName=&quot;input&quot; /&gt;&lt;/SelectFunction&gt;&lt;/SelectFunctions&gt;&lt;View&gt;&lt;LengthView&gt;&lt;EventCount&gt;1&lt;/EventCount&gt;&lt;/LengthView&gt;&lt;/View&gt;&lt;Guard&gt;&lt;fes:Filter xmlns:fes=&quot;http://www.opengis.net/fes/2.0&quot;&gt;&lt;fes:PropertyIsLessThanOrEqualTo&gt;&lt;fes:ValueReference&gt;input/doubleValue&lt;/fes:ValueReference&gt;&lt;ns:Literal xmlns:ns=&quot;http://www.opengis.net/fes/2.0&quot;&gt;&lt;ns1:Quantity xmlns:ns1=&quot;http://www.opengis.net/swe/1.0.1&quot;&gt;&lt;ns1:uom code=&quot;cm&quot; /&gt;&lt;ns1:value&gt;${thresholdValue}&lt;/ns1:value&gt;&lt;/ns1:Quantity&gt;&lt;/ns:Literal&gt;&lt;/fes:PropertyIsLessThanOrEqualTo&gt;&lt;/fes:Filter&gt;&lt;/Guard&gt;&lt;PropertyRestrictions&gt;&lt;PropertyRestriction&gt;&lt;name&gt;observedProperty&lt;/name&gt;&lt;value&gt;${observedProperty}&lt;/value&gt;&lt;/PropertyRestriction&gt;&lt;PropertyRestriction&gt;&lt;name&gt;sensorID&lt;/name&gt;&lt;value&gt;${sensorID}&lt;/value&gt;&lt;/PropertyRestriction&gt;&lt;/PropertyRestrictions&gt;&lt;/SimplePattern&gt;&lt;SimplePattern inputName=&quot;input&quot; patternID=&quot;${observedProperty}_threshold_overshoot&quot;&gt;&lt;SelectFunctions&gt;&lt;SelectFunction createCausality=&quot;false&quot; newEventName=&quot;${observedProperty}_threshold_overshoot_stream&quot;&gt;&lt;SelectEvent eventName=&quot;input&quot; /&gt;&lt;/SelectFunction&gt;&lt;/SelectFunctions&gt;&lt;View&gt;&lt;LengthView&gt;&lt;EventCount&gt;1&lt;/EventCount&gt;&lt;/LengthView&gt;&lt;/View&gt;&lt;Guard&gt;&lt;fes:Filter xmlns:fes=&quot;http://www.opengis.net/fes/2.0&quot;&gt;&lt;fes:PropertyIsGreaterThan&gt;&lt;fes:ValueReference&gt;input/doubleValue&lt;/fes:ValueReference&gt;&lt;ns:Literal xmlns:ns=&quot;http://www.opengis.net/fes/2.0&quot;&gt;&lt;ns1:Quantity xmlns:ns1=&quot;http://www.opengis.net/swe/1.0.1&quot;&gt;&lt;ns1:uom code=&quot;cm&quot; /&gt;&lt;ns1:value&gt;${thresholdValue}&lt;/ns1:value&gt;&lt;/ns1:Quantity&gt;&lt;/ns:Literal&gt;&lt;/fes:PropertyIsGreaterThan&gt;&lt;/fes:Filter&gt;&lt;/Guard&gt;&lt;PropertyRestrictions&gt;&lt;PropertyRestriction&gt;&lt;name&gt;observedProperty&lt;/name&gt;&lt;value&gt;Wasserstand&lt;/value&gt;&lt;/PropertyRestriction&gt;&lt;PropertyRestriction&gt;&lt;name&gt;sensorID&lt;/name&gt;&lt;value&gt;${sensorID}&lt;/value&gt;&lt;/PropertyRestriction&gt;&lt;/PropertyRestrictions&gt;&lt;/SimplePattern&gt;&lt;/SimplePatterns&gt;&lt;ComplexPatterns&gt;&lt;ComplexPattern patternID=&quot;${observedProperty}_initial_overshoot_count&quot;&gt;&lt;SelectFunctions&gt;&lt;SelectFunction createCausality=&quot;true&quot; newEventName=&quot;${observedProperty}_initial_overshoot_count_notification&quot; outputName=&quot;${observedProperty}_initial_overshoot_count_enter&quot;&gt;&lt;NotifyOnSelect&gt;&lt;Message&gt;Einstiegsklausel&lt;/Message&gt;&lt;/NotifyOnSelect&gt;&lt;/SelectFunction&gt;&lt;/SelectFunctions&gt;&lt;Guard&gt;&lt;fes:Filter xmlns:fes=&quot;http://www.opengis.net/fes/2.0&quot;&gt;&lt;fes:PropertyIsGreaterThanOrEqualTo&gt;&lt;fes:ValueReference&gt;${observedProperty}_initial_count_stream/doubleValue&lt;/fes:ValueReference&gt;&lt;ns:Literal xmlns:ns=&quot;http://www.opengis.net/fes/2.0&quot;&gt;&lt;ns1:Quantity xmlns:ns1=&quot;http://www.opengis.net/swe/1.0.1&quot;&gt;&lt;ns1:uom code=&quot;cm&quot; /&gt;&lt;ns1:value&gt;${thresholdValue}&lt;/ns1:value&gt;&lt;/ns1:Quantity&gt;&lt;/ns:Literal&gt;&lt;/fes:PropertyIsGreaterThanOrEqualTo&gt;&lt;/fes:Filter&gt;&lt;/Guard&gt;&lt;StructuralOperator&gt;&lt;CAUSE /&gt;&lt;/StructuralOperator&gt;&lt;FirstPattern&gt;&lt;PatternReference&gt;${observedProperty}_initial_count&lt;/PatternReference&gt;&lt;SelectFunctionNumber&gt;0&lt;/SelectFunctionNumber&gt;&lt;/FirstPattern&gt;&lt;SecondPattern&gt;&lt;PatternReference&gt;${observedProperty}_initial_count&lt;/PatternReference&gt;&lt;SelectFunctionNumber&gt;0&lt;/SelectFunctionNumber&gt;&lt;/SecondPattern&gt;&lt;/ComplexPattern&gt;&lt;ComplexPattern patternID=&quot;${observedProperty}_threshold_overshoot_notification&quot;&gt;&lt;SelectFunctions&gt;&lt;SelectFunction createCausality=&quot;true&quot; newEventName=&quot;${observedProperty}_threshold_overshoot_notification_stream&quot; outputName=&quot;${observedProperty}_threshold_enter&quot;&gt;&lt;NotifyOnSelect&gt;&lt;Message&gt;Einstiegsklausel&lt;/Message&gt;&lt;/NotifyOnSelect&gt;&lt;/SelectFunction&gt;&lt;/SelectFunctions&gt;&lt;StructuralOperator&gt;&lt;BEFORE /&gt;&lt;/StructuralOperator&gt;&lt;FirstPattern&gt;&lt;PatternReference&gt;${observedProperty}_threshold_undershoot&lt;/PatternReference&gt;&lt;SelectFunctionNumber&gt;0&lt;/SelectFunctionNumber&gt;&lt;/FirstPattern&gt;&lt;SecondPattern&gt;&lt;PatternReference&gt;${observedProperty}_threshold_overshoot&lt;/PatternReference&gt;&lt;SelectFunctionNumber&gt;0&lt;/SelectFunctionNumber&gt;&lt;/SecondPattern&gt;&lt;/ComplexPattern&gt;&lt;ComplexPattern patternID=&quot;${observedProperty}_threshold_undershoot_notification&quot;&gt;&lt;SelectFunctions&gt;&lt;SelectFunction createCausality=&quot;true&quot; newEventName=&quot;${observedProperty}_threshold_undershoot_notification_stream&quot; outputName=&quot;${observedProperty}_threshold_exit&quot;&gt;&lt;NotifyOnSelect&gt;&lt;Message&gt;Ausstiegsklausel&lt;/Message&gt;&lt;/NotifyOnSelect&gt;&lt;/SelectFunction&gt;&lt;/SelectFunctions&gt;&lt;StructuralOperator&gt;&lt;BEFORE /&gt;&lt;/StructuralOperator&gt;&lt;FirstPattern&gt;&lt;PatternReference&gt;${observedProperty}_threshold_overshoot&lt;/PatternReference&gt;&lt;SelectFunctionNumber&gt;0&lt;/SelectFunctionNumber&gt;&lt;/FirstPattern&gt;&lt;SecondPattern&gt;&lt;PatternReference&gt;${observedProperty}_threshold_undershoot&lt;/PatternReference&gt;&lt;SelectFunctionNumber&gt;0&lt;/SelectFunctionNumber&gt;&lt;/SecondPattern&gt;&lt;/ComplexPattern&gt;&lt;/ComplexPatterns&gt;&lt;TimerPatterns /&gt;&lt;RepetitivePatterns /&gt;&lt;/EML&gt;",
        "contentType" : "application/xml"
    }
}
